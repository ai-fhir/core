description:
  Профиль пациента для документа Протокол лабораторного исследования.
  Часть полей может уйти в базовый профиль после проверки и объединения.
elements:
  name:
    description: Имена пациента
    elements:
      use:
        constant: official
        description: Фиксированое значение - official
      given:
        description: Имя и Отчество пациента. Первым должно идти Имя, вторым Отчество
        minItems: 1
      family:
        description: Фамилия пациента
        required: true
  gender:
    required: true
    valueset:
      id: fhir:administrative-gender
      concepts:
        - code: male
          display: Мужчина
        - code: female
          display: Женщина
        - code: unknown
          display: Неопределенный
  birthDate:
    description: В формате yyyyMMdd
    required: true
    regexp: "\\d{4}\\-\\d{2}\\-\\d{2}"
  telecom:
    description: "Телефон и прочие контакты пациента. Основной телефон должен иметь rank = 1. TODO: Можно ли запрофилировать cellphone?"
    elements:
      value:
        required: true
      system:
        required: true  
        valueset: 
          id: 'fhir:contact-point-system'
          concepts:
            - code: phone
              display: Телефон
            - code: email
              display: Электронная почта
    slices:
      phone:
        match:
          system: "phone, regexp: \\+7\\d{10}"
  identifier:
    description: "Идентификационные данные пациента: удостоверение личности, СНИЛС, уникальный идентификатор пациента в МИС"
    minItems: 3
    slices:
      pasport:
        match:
          type: PPN
        constant:
          use: "official"
        description: Документ, удостоверяющий личность пациента
        required: true
      snils:
        description: СНИЛС
        required: true
        match:
          type: SNILS
          value: "regexp: \\d{3}\\-\\d{3}\\-\\d{3} \\d{2}"
      mis-id:
        description: "Уникальный идентификатор пациента в МИС. system = urn:mr_id:<id мед организации>:<Номер МИС>:<Номер инстанса>"
        required: true
        match:
          type: MR
        constant:
          use: "official"
    elements:
      use: {}
      type: {}
      system: {}
      value: {required: true}
      period: {}
      assigner: {required: true}
  address:
    descrption: Адреса пациента
    minItems: 2
    elements:
      text: { required: true }
      state: 
        required: true
        valueset:
          id: ru-administrative-area
